<!DOCTYPE html>
<html lang="en">
<head>
    <link rel="icon" type="image/png" href="assets/logo.png">
  <meta charset="UTF-8">

  <!-- Font Awesome icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

  <!-- Responsive viewport -->
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- Google Fonts: Poppins -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap" rel="stylesheet">

  <!-- Main stylesheet -->
  <link rel="stylesheet" href="style.css">

  <title>Highlights, Frisco</title>
</head>

<body>
  <!-- Page Loading Progress Bar -->
  <div id="progressBar" class="progress-bar"></div>

  <!-- Skip to main content -->
  <a href="#main" class="skip-to-main">Skip to main content</a>

  <!-- =========================================================
       NAVIGATION BAR (SUB-HEADER)
       ======================================================= -->
  <section class="sub-header">
    <nav>
      <!-- Theme toggle button (light/dark mode) -->
      <button id="theme-toggle" aria-label="Toggle light/dark mode"></button>

      <!-- Logo linking to home -->
      <a href="index.html">
        <img src="assets/logo.png" class="logo" alt="Frisco-City-Logo">
      </a>

      <!-- Navigation links (desktop + mobile) -->
      <div class="nav-links" id="navLinks">
        <div class="cross-icon" onclick="hideMenu()"></div>
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="about.html">About</a></li>
          <li><a href="blogs.html">Blogs</a></li>
          <li><a href="highlights.html" class="nav-active">Highlights</a></li>
          <li><a href="resources.html">Resources</a></li>
          <li><a href="references.html">References</a></li>
        </ul>
      </div>

      <!-- Hamburger icon (mobile) -->
      <div class="menu-icon-unicode" onclick="showMenu()">&#9776;</div>
    </nav>
  </section>

  

  <!-- =========================================================
       BANNER SECTION
       ======================================================= -->
  <section class="blog-content">
    <div class="banner5">
      <img src="assets/banner_5.jpg" alt="Frisco Resources Banner">
    </div>
    <div class="banner-text">
      <h1>Frisco In Focus</h1>
      <p>See what’s happening around Frisco — from holiday celebration to local sports and community gatherings</p>
    </div>
  </section>

  <!-- =========================================================
       POPULATION LINE CHART (Highlights page)
       Inserted between Highlights and Featured Resources
       ======================================================= -->
  

  <main id="main">

  <!-- =========================================================
       HIGHLIGHTS SECTION
       ======================================================= -->
  <section class="tour1">
    <h2 class="news">Community Highlights</h2>
    <p>A quick look at what's new, what's exciting, and what's making an impact.</p>

    <div class="row">
      <!-- Highlight 1 -->
      <div class="event-col2 reveal reveal-bottom">
        <img src="assets/turkey.png" alt="Turkey-Race">
        <div class="layer">
          <h3>Frisco Turkey marathon</h3>
        </div>
        <p>The Frisco Turkey Day 5k is a Thanksgiving morning jog starting from the Old Frisco Community center. All ages are welcome to participate, and the event will follow a 5k route throughout Frisco. Participants are encouraged to bring food donations for the community. It is an annual marathon that includes a 1-mile fun run, a 5k, and a 10k — an annual tradition at Frisco for Thanksgiving with the slogan “Run First, Eat Later”.</p>
      </div>

      <!-- Highlight 2 -->
      <div class="event-col2 reveal reveal-bottom" id="second">
        <img src="assets/christmas.webp" alt="Christmas">
        <div class="layer">
          <h3>Frisco Square Christmas Lightings</h3>
        </div>
        <p>Christmas in the Square is a free holiday light and music show in Frisco featuring over 180,000 synchronized lights displayed nightly from 6–10 PM. The event transforms Frisco Square into a festive winter setting with choreographed light displays and optional seasonal activities like ice skating at Skate the Square. Many music tracks are specially choreographed just for this event.</p>
      </div>

      <!-- Highlight 3 -->
      <div class="event-col2 reveal reveal-bottom">
        <img src="assets/football.webp" alt="Game-Toyota-Stadium">
        <div class="layer">
          <h3>Frisco FootBall game (Highschool)</h3>
        </div>
        <p>Toyota Stadium hosts a variety of public events, including the one that just happened — Draw Watch Party on December 5 at 11:00 AM featured food and drink specials, raffles, giveaways, and merchandise discounts. In general, this venue also offers event space rentals and follows standard cashless parking and security policies.</p>
      </div>

      <!-- Highlight 4 -->
      <div class="event-col2 reveal reveal-bottom">
        <img src="assets/awards-gala.PNG" alt="Awards-Gala">
        <div class="layer">
          <h3>Annual Awards gala</h3>
        </div>
        <p>Frisco Chamber of Commerce hosts an unforgettable evening of celebration and recognition at the Annual Awards Gala, held at the stunning Omni PGA Frisco Resort. With over 600 of Frisco’s top business leaders in attendance, this prestigious event is the perfect opportunity to celebrate success and foster new connections.</p>
      </div>

      <!-- Highlight 5 -->
      <div class="event-col2 reveal reveal-bottom">
        <img src="assets/kaleidoscope.webp" alt="Kalaeidoscope Park">
        <div class="layer">
          <h3>Kaleidoscope Park</h3>
        </div>
        <p>Kaleidoscope Park’s programs are curated to engage audiences and genuinely represent the diverse and growing communities throughout North Texas. Kaleidoscope Park will present a variety of year-round activities including concerts, films, diverse musical and dance performances, and a variety of health and recreational activities. Kaleidoscope Park will focus on energetic and distinctive programming that will always be free and open to the public.</p>
      </div>
    </div>
  </section>
  <!-- =========================================================
       POPULATION LINE CHART (Highlights page)
       Inserted between Highlights and Featured Resources
       ======================================================= -->
  <section class="population-chart" aria-labelledby="popChartTitle">
    <div class="chart-header">
      <h2 id="popChartTitle">Frisco Population Growth (2010–2025)</h2>
      <p class="chart-sub">This chart visualizes a key trend shaping Frisco’s growth over time.</p>
    </div>

    <div class="chart-holder">
      <div class="y-axis-title" aria-hidden="true">Estimated Population</div>
      <canvas id="popChart" role="img" aria-label="Line chart showing Frisco population growth from 2010 to 2025" aria-describedby="popChartSummary"></canvas>
    </div>

    <p class="chart-caption">This chart illustrates Frisco’s steady population growth over the past decade, highlighting the increasing demand for infrastructure, schools, and community services.</p>

    <!-- Accessible data table for screen readers (annual series shown every 2 years plus 2025) -->
    <table class="visually-hidden" aria-hidden="false">
      <caption>Frisco population estimates used to draw the chart (2010–2025)</caption>
      <thead>
        <tr><th>Year</th><th>Estimated Population</th></tr>
      </thead>
      <tbody>
        <tr><td>2010</td><td>~116,000</td></tr>
        <tr><td>2013</td><td>~130,250</td></tr>
        <tr><td>2016</td><td>~150,000</td></tr>
        <tr><td>2019</td><td>~182,500</td></tr>
        <tr><td>2022</td><td>~215,000</td></tr>
        <tr><td>2025</td><td>~237,500</td></tr>
      </tbody>
    </table>

    <p class="data-source">Data source: U.S. Census Bureau / City of Frisco (estimates).</p>
  </section>

  <script>
  (function(){
    // Known sample points (authoritative sources)
    const known = [
      {y:2010, v:116000},
      {y:2014, v:135000},
      {y:2018, v:165000},
      {y:2020, v:200000},
      {y:2022, v:215000},
      {y:2024, v:230000}
    ];

    // Build an annual series from start..end (inclusive) by linear interpolation/extrapolation
    function buildSeries(knownPoints, startYear=2010, endYear=2025) {
      const sorted = knownPoints.slice().sort((a,b)=>a.y-b.y);
      const mapKnown = new Map(sorted.map(p=>[p.y,p.v]));
      const series = [];

      function interp(y) {
        if (mapKnown.has(y)) return mapKnown.get(y);
        // find surrounding known points
        let lo = null, hi = null;
        for (let i=0;i<sorted.length;i++){
          if (sorted[i].y < y) lo = sorted[i];
          if (sorted[i].y > y) { hi = sorted[i]; break; }
        }
        if (!lo && hi) return hi.v;
        if (!hi && lo) {
          // extrapolate using last two known points
          const a = sorted[sorted.length-2], b = sorted[sorted.length-1];
          const slope = (b.v - a.v) / (b.y - a.y);
          return Math.round(b.v + slope * (y - b.y));
        }
        if (lo && hi) {
          const t = (y - lo.y) / (hi.y - lo.y);
          return Math.round(lo.v + t * (hi.v - lo.v));
        }
        return sorted[0].v;
      }

      for (let y = startYear; y <= endYear; y++) {
        series.push({ y, v: interp(y) });
      }
      return series;
    }

    const data = buildSeries(known, 2010, 2025);

    function distanceToSegment(px, py, x1, y1, x2, y2) {
      const A = px - x1, B = py - y1, C = x2 - x1, D = y2 - y1;
      const dot = A * C + B * D;
      const len_sq = C * C + D * D;
      let param = -1;
      if (len_sq !== 0) param = dot / len_sq;
      let xx, yy;
      if (param < 0) { xx = x1; yy = y1; }
      else if (param > 1) { xx = x2; yy = y2; }
      else { xx = x1 + param * C; yy = y1 + param * D; }
      const dx = px - xx; const dy = py - yy;
      return Math.sqrt(dx * dx + dy * dy);
    }

    function drawPopulationChart() {
      const canvas = document.getElementById('popChart');
      if (!canvas || !canvas.getContext) return;
      const holder = canvas.parentElement;
      const maxW = Math.min(900, holder.clientWidth || 800);
      // on narrow/mobile widths, make the chart taller while keeping width the same
      const isMobileLayout = holder.clientWidth <= 520 || window.matchMedia('(max-width:520px)').matches;
      canvas.width = maxW;
      const heightRatio = isMobileLayout ? 0.75 : 0.45;
      canvas.height = Math.round(maxW * heightRatio);
      const ctx = canvas.getContext('2d');
      const w = canvas.width, h = canvas.height;
      ctx.clearRect(0,0,w,h);

      // compute scales and padding
      ctx.font = '12px Poppins, sans-serif';
      // read theme-aware colors once (trim to avoid leading whitespace)
      const cs = getComputedStyle(document.documentElement);
      const bgCard = (cs.getPropertyValue('--bg-card') || '#fff').trim();
      const textMain = (cs.getPropertyValue('--text-main') || '#333').trim();
      const textMuted = (cs.getPropertyValue('--text-muted') || '#666').trim();
      const borderSoft = (cs.getPropertyValue('--border-soft') || '#e6e6e6').trim();
      const accent = (cs.getPropertyValue('--accent-primary') || '#0077cc').trim();
      // ensure canvas CSS background matches theme (helps in light mode)
      try { canvas.style.background = bgCard; } catch(e) {}
      const vals = data.map(d=>d.v);
      const minV = Math.min(...vals) * 0.95;
      const maxV = Math.max(...vals) * 1.05;
      const ticks = 5;
      let widest = 0;
      for (let i=0;i<=ticks;i++) {
        const tVal = Math.round(minV + (i*(maxV-minV)/ticks));
        const m = ctx.measureText(tVal.toLocaleString()).width;
        if (m > widest) widest = m;
      }
      const pad = { left: Math.max(140, Math.ceil(widest) + 48), right:20, top:28, bottom: (isMobileLayout ? 96 : 68) };
      const cx = pad.left, cy = pad.top;
      const chartW = w - pad.left - pad.right;
      const chartH = h - pad.top - pad.bottom;
      const xStep = chartW / (data.length - 1);
      const yScale = v => chartH - ((v - minV) / (maxV - minV)) * chartH;

      // background
      ctx.fillStyle = bgCard || '#fff';
      ctx.fillRect(0,0,w,h);

      // axes
      ctx.strokeStyle = textMain || '#333'; ctx.lineWidth = 1;
      ctx.beginPath(); ctx.moveTo(cx, cy); ctx.lineTo(cx, cy + chartH); ctx.lineTo(cx + chartW, cy + chartH); ctx.stroke();

      // y ticks
      ctx.fillStyle = textMuted || '#666'; ctx.font = '12px Poppins, sans-serif'; ctx.textAlign = 'right';
      for (let i=0;i<=ticks;i++){
        const tVal = Math.round(minV + (i*(maxV-minV)/ticks));
        const y = cy + yScale(tVal);
        ctx.strokeStyle = borderSoft || '#e6e6e6'; ctx.lineWidth = 1;
        ctx.beginPath(); ctx.moveTo(cx, y); ctx.lineTo(cx + chartW, y); ctx.stroke();
        ctx.fillStyle = textMuted || '#333'; ctx.fillText(tVal.toLocaleString(), cx - 8, y + 4);
      }

      // x labels (show every 2 years for readability)
      ctx.textAlign = 'center'; ctx.font = '13px Poppins, sans-serif';
      data.forEach((d,i)=>{
        const x = cx + i * xStep;
        // show labels every 3 years starting at 2010, and always include 2025
        if (((d.y - 2010) % 3 === 0) || d.y === 2025) {
          ctx.fillStyle = textMain || '#333';
          ctx.fillText(String(d.y), x, cy + chartH + 26);
        }
      });

      // line path and markers (markers shown every 2 years + 2025)
      const points = data.map((d,i)=>({ x: cx + i * xStep, y: cy + yScale(d.v), d }));
      ctx.beginPath(); points.forEach((p,i)=> i===0 ? ctx.moveTo(p.x,p.y) : ctx.lineTo(p.x,p.y));
      ctx.strokeStyle = accent || '#0077cc'; ctx.lineWidth = 2.8; ctx.stroke();
      points.forEach(p=>{
        // draw markers every 3 years and on 2025
        if (((p.d.y - 2010) % 3 === 0) || p.d.y === 2025) {
          ctx.fillStyle = bgCard || '#fff'; ctx.strokeStyle = accent || '#0077cc'; ctx.lineWidth = 2; ctx.beginPath(); ctx.arc(p.x,p.y,4,0,Math.PI*2); ctx.fill(); ctx.stroke();
        }
      });

      // axis labels
      ctx.fillStyle = textMain || '#333'; ctx.font = '14px Poppins, sans-serif'; ctx.textAlign = 'center';
      ctx.fillText('Year', cx + chartW/2, cy + chartH + 46);

      // store points for tooltip
      canvas._chartPoints = points;
    }

    function ensureTooltip() {
      const holder = document.querySelector('.population-chart .chart-holder');
      if (!holder) return null;
      let tip = holder.querySelector('.chart-tooltip');
      if (!tip) {
        tip = document.createElement('div'); tip.className = 'chart-tooltip'; tip.setAttribute('role','status'); tip.style.display = 'none';
        holder.style.position = holder.style.position || 'relative';
        holder.appendChild(tip);
      }
      return tip;
    }

    function setupInteractions() {
      const canvas = document.getElementById('popChart');
      if (!canvas) return;
      const tip = ensureTooltip();
      function hide() { if (tip) tip.style.display = 'none'; }
      function onMove(e) {
        const rect = canvas.getBoundingClientRect();
        const x = (e.clientX - rect.left) * (canvas.width / rect.width);
        const y = (e.clientY - rect.top) * (canvas.height / rect.height);
        // redraw baseline chart (keeps drawing code consolidated)
        drawPopulationChart();
        const ctx = canvas.getContext('2d');
        const points = canvas._chartPoints || [];
        if (!points.length) return hide();

        // find the segment containing x (or clamp to endpoints)
        let interp = null;
        if (x <= points[0].x) {
          interp = {x: points[0].x, y: points[0].y, year: points[0].d.y, val: points[0].d.v};
        } else if (x >= points[points.length-1].x) {
          const p = points[points.length-1]; interp = {x: p.x, y: p.y, year: p.d.y, val: p.d.v};
        } else {
          for (let i=0;i<points.length-1;i++){
            const p = points[i], q = points[i+1];
            if (x >= p.x && x <= q.x) {
              const t = (x - p.x) / (q.x - p.x);
              const iy = p.y + t * (q.y - p.y);
              const year = Math.round(p.d.y + t * (q.d.y - p.d.y));
              const val = Math.round(p.d.v + t * (q.d.v - p.d.v));
              interp = {x: p.x + t * (q.x - p.x), y: iy, year, val};
              break;
            }
          }
        }

        if (!interp) return hide();

        // draw gliding grey dot (outer halo + white core for contrast)
        ctx.beginPath();
        ctx.fillStyle = 'rgba(200,200,200,0.98)';
        ctx.strokeStyle = 'rgba(0,0,0,0.18)';
        ctx.lineWidth = 1.5;
        ctx.arc(interp.x, interp.y, 6, 0, Math.PI*2);
        ctx.fill();
        ctx.stroke();
        // inner core
        ctx.beginPath(); ctx.fillStyle = getComputedStyle(document.documentElement).getPropertyValue('--bg-card') || '#fff'; ctx.arc(interp.x, interp.y, 3, 0, Math.PI*2); ctx.fill();

        // show tooltip with interpolated year & population
        if (!tip) return;
        tip.style.display = 'block';
        tip.innerHTML = `<strong>${interp.year}</strong><div>${interp.val.toLocaleString()}</div>`;
        const holderRect = canvas.parentElement.getBoundingClientRect();
        const left = Math.min(holderRect.width - 120, Math.max(8, (e.clientX - holderRect.left) + 8));
        const top = Math.max(8, (e.clientY - holderRect.top) - 46);
        tip.style.left = left + 'px'; tip.style.top = top + 'px';
      }
      canvas.addEventListener('mousemove', onMove);
      canvas.addEventListener('mouseleave', ()=>{ hide(); drawPopulationChart(); });
      // touch support: map touches to mouse-like events and redraw
      canvas.addEventListener('touchstart', (ev)=>{ if (ev.touches && ev.touches[0]) onMove(ev.touches[0]); }, {passive:true});
      canvas.addEventListener('touchmove', (ev)=>{ if (ev.touches && ev.touches[0]) onMove(ev.touches[0]); }, {passive:true});
      canvas.addEventListener('touchend', ()=>{ hide(); drawPopulationChart(); });
    }

    function init() { drawPopulationChart(); setupInteractions(); }

    if (document.readyState === 'complete' || document.readyState === 'interactive') setTimeout(init, 60);
    else document.addEventListener('DOMContentLoaded', init);
    let rt = null; window.addEventListener('resize', ()=>{ clearTimeout(rt); rt = setTimeout(()=>{ drawPopulationChart(); }, 150); });
    // expose redraw so other scripts (theme toggle) can refresh the canvas immediately
    try { window.drawPopulationChart = drawPopulationChart; } catch(e) {}
  })();
  </script>

  <!-- =========================================================
       FEATURED RESOURCES SPOTLIGHT
       ======================================================= -->
  <section class="featured-resources">
    <div class="featured-header">
      <h2>Featured Community Resources</h2>
      <p>Highlighted resources making a difference in Frisco</p>
    </div>
    
    <div class="featured-grid">
      <!-- Featured Resource 1 -->
      <div class="featured-card reveal reveal-bottom">
        <div class="featured-icon"><i class="fa fa-book"></i></div>
        <h3>Frisco Public Library</h3>
        <p class="featured-category">Education & Learning</p>
        <p class="featured-desc">The Frisco Public Library serves as a knowledge hub for all ages, offering books, digital resources, community learning programs, and research support. Visit for free library card registration and explore thousands of resources.</p>
        <a href="https://friscolibrary.bibliocommons.com/user/login?destination=https%3A%2F%2Ffriscolibrary.com" target="_blank" class="featured-link">Learn More</a>
      </div>

      <!-- Featured Resource 2 -->
      <div class="featured-card reveal reveal-bottom">
        <div class="featured-icon"><i class="fa fa-hospital-o"></i></div>
        <h3>Baylor Scott & White Medical Center</h3>
        <p class="featured-category">Health & Wellness</p>
        <p class="featured-desc">Premier healthcare facility providing comprehensive medical services including emergency care, surgical procedures, and specialty clinics. Committed to serving the health needs of the entire Frisco community.</p>
        <a href="https://www.bswhealth.com" target="_blank" class="featured-link">Learn More</a>
      </div>

      <!-- Featured Resource 3 -->
      <div class="featured-card reveal reveal-bottom">
        <div class="featured-icon"><i class="fa fa-users"></i></div>
        <h3>Play Frisco Recreation</h3>
        <p class="featured-category">Community Programs & Recreation</p>
        <p class="featured-desc">Play Frisco brings the community together with diverse recreation programs, parks, sports activities, and cultural events for all ages. Explore opportunities to stay active, make friends, and create lasting memories.</p>
        <a href="https://www.playfrisco.org" target="_blank" class="featured-link">Learn More</a>
      </div>
    </div>
  </section>

  <div style="text-align: center; margin: 40px 0;">
    <a href="resources.html" class="btn1">View All Resources</a>
  </div>

  

  </main>

  <!-- =========================================================
       FOOTER
       ======================================================= -->
  <section class="footer">
    <footer>
      <!-- Footer logo -->
      <div class="logo">
        <img src="assets/logo.png" alt="Frisco-City-Logo">
      </div>
      <!-- Contact info -->
      <h4>Contact Us</h4>
      <div class="text-container">
        <p>George A. Purefoy Municipal Center</p>
        <p>6101 Frisco Square Boulevard</p>
        <p>Frisco, Texas 75034</p>
        <p>Phone: 972-292-5000</p>
      </div>
      <!-- Departments list -->
<h4 class="departments">Departments</h4>
<div class="text-container2 footer-dept-links">
  <p><a href="https://www.friscotexas.gov/506/City-Manager" target="_blank">City Manager’s Office</a></p>
  <p><a href="https://www.friscoedc.com" target="_blank">Economic Development</a></p>
  <p><a href="https://www.friscotexas.gov/154/Fire" target="_blank">Frisco Fire</a></p>
  <p><a href="https://www.friscotexas.gov/100/Police" target="_blank">Frisco Police</a></p>
  <p><a href="https://www.friscotexas.gov/167/Municipal-Court" target="_blank">Municipal Court</a></p>
  <p><a href="https://www.playfrisco.org" target="_blank">Play Frisco</a></p>
  <p><a href="https://www.visitfrisco.com" target="_blank">Visit Frisco</a></p>
</div>

      <!-- Social media links -->
      <div class="footer-column follow-column">
        <h4 class="follow">Follow Us</h4>
        <div class="text-container3">
          <a href="https://www.facebook.com/CityOfFriscoTX" class="fa fa-facebook" target="_blank" rel="noopener noreferrer" aria-label="City of Frisco Facebook"></a>
          <a href="https://www.instagram.com/cityoffriscotx/" class="fa fa-instagram" target="_blank" rel="noopener noreferrer" aria-label="City of Frisco Instagram"></a>
          <a href="https://www.youtube.com/user/cityoffriscotx" class="fa fa-youtube" target="_blank" rel="noopener noreferrer" aria-label="City of Frisco YouTube"></a>
          <a href="https://www.linkedin.com/company/city-of-frisco/" class="fa fa-linkedin" target="_blank" rel="noopener noreferrer" aria-label="City of Frisco LinkedIn"></a>
        </div>
      </div>
    </footer>
  </section>

  <!-- =========================================================
       JAVASCRIPT: NAVIGATION + THEME TOGGLE
       ======================================================= -->
  <script>
    // Open mobile navigation
    function showMenu() {
      const navLinks = document.getElementById('navLinks');
      navLinks.style.right = '0';
    }

    // Close mobile navigation
    function hideMenu() {
      const navLinks = document.getElementById('navLinks');
      navLinks.style.right = '-200px';
    }
// Cookie-based storage: localStorage unavailable in Claude.ai artifact environment
const appStorage = {
  getItem(key) {
    const re = new RegExp('(?:^|; )' + key.replace(/[.*+?^${}()|[\\]\\]/g, '\\$&') + '=([^;]*)');
    const match = document.cookie.match(re);
    return match ? decodeURIComponent(match[1]) : null;
  },
  setItem(key, value, days = 365) {
    const d = new Date();
    d.setTime(d.getTime() + days * 24 * 60 * 60 * 1000);
    document.cookie = key + '=' + encodeURIComponent(String(value)) + ';path=/;expires=' + d.toUTCString();
  },
  removeItem(key) {
    document.cookie = key + '=;path=/;expires=Thu, 01 Jan 1970 00:00:00 GMT';
  }
};

const toggleBtn = document.getElementById('theme-toggle');
const root = document.documentElement;

// Load saved theme (using appStorage instead of localStorage)
const savedTheme = appStorage.getItem('theme');

// If the saved theme is "light", enable light mode
if (savedTheme === 'light') {
  root.classList.add('light-theme');
  toggleBtn.textContent = 'Toggle Dark Mode On';
} else {
  // Otherwise, force dark mode and save it as default
  root.classList.remove('light-theme');
  appStorage.setItem('theme', 'dark');
  toggleBtn.textContent = 'Toggle Light Mode On';
}

// Theme toggle logic with a subtle overlay cross-fade
toggleBtn.addEventListener('click', () => {
  const DURATION = 420;
  const overlay = document.createElement('div');
  overlay.className = 'theme-fade';
  document.body.appendChild(overlay);
  void overlay.offsetWidth;
  overlay.classList.add('show');

  document.documentElement.classList.add('theme-transition');

  window.setTimeout(() => {
    const isLight = root.classList.toggle('light-theme');
    appStorage.setItem('theme', isLight ? 'light' : 'dark');
    toggleBtn.textContent = isLight ? 'Toggle Dark Mode On' : 'Toggle Light Mode On';

    // redraw theme-aware canvas immediately
    try { requestAnimationFrame(()=>{ if (window.drawPopulationChart) window.drawPopulationChart(); }); } catch(e) {}
  }, 40);

  window.setTimeout(() => {
    overlay.classList.remove('show');
    document.documentElement.classList.remove('theme-transition');
    window.setTimeout(() => { if (overlay && overlay.parentNode) overlay.parentNode.removeChild(overlay); }, 220);
  }, DURATION + 40);
});

// =========================================================
// PAGE LOADING PROGRESS BAR
// =========================================================
const progressBar = document.getElementById('progressBar');

// Start progress bar when page starts loading
window.addEventListener('beforeunload', () => {
  progressBar.classList.add('active');
  progressBar.style.width = '30%';
});

// Complete progress bar when page finishes loading
window.addEventListener('load', () => {
  progressBar.style.width = '100%';
  progressBar.classList.remove('active');
  progressBar.classList.add('complete');
  
  // Fade out progress bar after completion
  setTimeout(() => {
    progressBar.classList.add('fade');
  }, 1500);
});

// Initialize progress bar on page load
document.addEventListener('DOMContentLoaded', () => {
  const observerOptions = {
    root: null,
    threshold: 0.05, // Lower threshold = starts sooner
    rootMargin: '0px 0px -20px 0px' // Offset to trigger slightly before visibility
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.add('active');
        // If you want it to re-animate every time you scroll back up, 
        // DO NOT use observer.unobserve(entry.target);
      }
    });
  }, observerOptions);

  // Select and observe all elements with the reveal class
  document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
});
</script>
</script>
<script>
// Consolidated page init: progress bar + observer + link progress
function initPage() {
  try { progressBar.style.width = '60%'; progressBar.classList.add('active'); } catch (e) {}
  try {
    const observerOptions = { root: null, threshold: 0.05, rootMargin: '0px 0px -20px 0px' };
    const observer = new IntersectionObserver((entries) => { entries.forEach(entry => { if (entry.isIntersecting) entry.target.classList.add('active'); }); }, observerOptions);
    document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
  } catch (e) {}

  document.addEventListener('click', (e) => {
    const link = e.target.closest('a');
    if (link && link.href && !link.target && !link.href.startsWith('#')) {
      try { progressBar.style.width = '30%'; progressBar.classList.add('active'); progressBar.classList.remove('complete', 'fade'); } catch (ee) {}
    }
  });
}

document.addEventListener('DOMContentLoaded', initPage);
</script>
</script>
</body>
</html>
